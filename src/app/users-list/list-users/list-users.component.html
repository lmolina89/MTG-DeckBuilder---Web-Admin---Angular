<p-table
  [tableStyle]="{ 'min-width': '50rem' }"
  [value]="usersList"
  [loading]="loading"
  [rows]="10"
  [paginator]="true"
  [rowsPerPageOptions]="[5, 10, 20]"
>
  <!--  header-->
  <ng-template pTemplate="header" class="background-tabla">
    <tr  class="background-tabla">
      <th class="background-tabla">Nick</th>
      <th>Email</th>
      <th>Imagen</th>
      <th>Activo</th>
      <th>Administrador</th>
      <th></th>
      <th>
<!--        boton nuevo usuario-->
        <p-button
        label="Crear usuario"
        styleClass="p-button-outlined p-button-help p-button-sm"
        (click)="newUserHandler()"
        >
        </p-button>
      </th>
    </tr>
  </ng-template>
  <!--  datos de la tabla-->
  <ng-template pTemplate="body" let-user>
    <tr>
      <td>{{ user.nick }}</td>
      <td>{{ user.email }}</td>
      <td>{{ user.imgUri }}</td>
      <td>{{ user.active == 1 ? 'si' : 'no' }}</td>
      <td>{{ user.admin == 1 ? 'si' : 'no' }}</td>

      <!--      boton editar-->
      <td>
        <p-button
          icon="pi pi-user-edit"
          label="Editar"
          styleClass="p-button-rounded p-button-raised p-button-secondary p-button-sm"
          (click)="editHandler(user)"
        >
        </p-button>
      </td>
      <!--      boton eliminar-->
      <td>
        <p-button
          icon="pi pi-times"
          label="Eliminar"
          styleClass="p-button-rounded p-button-raised p-button-danger p-button-sm"
          (click)="confirmDelete(user)"
        >
        </p-button>
      </td>
    </tr>
  </ng-template>

  <!--  footer-->
  <ng-template
    pTemplate="summary"

  >
    <div class="d-flex justify-content-start align-items-center">
      <div class="mx-4">
        Existen {{usersList ? usersList.length : 0 }} usuarios.
      </div>

    </div>

  </ng-template>
</p-table>


<!--formulario de edicion-->
<p-dialog
  header="Editar usuario"
  [visible]="activeEdit"
  [style]="{ width: '45vw' }"
  (cancel)="cancelHandler()"
>
  <form
    class="formbox"
  >
    <div class=" mb-4 mt-2 mx-4 d-flex justify-content-between">
        <span class="p-float-label">
          <input
            id="email"
            pInputText
            class="p-inputtext-lg"
            name="email"
            [disabled]="true"
            [(ngModel)]="selectedUser.email"
          />
          <label for="email">Email</label>
        </span>
      <span class="p-float-label">
          <input
            id="nick"
            pInputText
            class="p-inputtext-lg"
            name="nick"
            [disabled]="true"
            [(ngModel)]="selectedUser.nick"
          />
          <label for="nick">Nick</label>
        </span>
    </div>
    <div class=" mb-4 mt-2 mx-4 d-flex justify-content-between">
      <span class="p-float-label">
        <input
          pInputText
          id="imageUri"
          class="p-inputtext-lg"
          name="imageUri"
          [disabled]="true"
          [(ngModel)]="selectedUser.imageUri"
        />
        <label for="imageUri">Imagen</label>
      </span>
      <p-image
        *ngIf="selectedUser.imageUri"
        [src]="selectedUser.imageUri? selectedUser.imageUri: ''"
        alt="Image"
        width="100"
        [preview]="true"
      >
      </p-image>
    </div>

    <div class="flex justify-content-around mt-5">
      <p-selectButton
        name="active"
        [options]="activeStateOptions"
        [(ngModel)]="selectedUser.active"
        optionLabel="label"
        optionValue="value"
      >
      </p-selectButton>
      <p-selectButton
        name="admin"
        [options]="adminStateOptions"
        [(ngModel)]="selectedUser.admin"
        optionLabel="label"
        optionValue="value">
      </p-selectButton>
    </div>

    <p-divider></p-divider>

    <div class="flex justify-content-around mt-5">
      <p-button
        type="button"
        label="Guardar"
        styleClass="
        p-button-raised"
        (click)="saveHandler()"
      >
      </p-button>
      <p-button
        type="button"
        label="Cancelar"
        styleClass="
        p-button-raised
        p-button-danger"
        (click)="cancelHandler()"
      >
      </p-button>
    </div>
  </form>
</p-dialog>


<!--dialogo de eliminar-->
<p-confirmDialog
  [visible]="activeDelete"
  [style]="{ width: '50vw' }"
>
  <p-footer>
    <button
      type="button"
      pButton icon="pi pi-check"
      label="Confirmar"
      (click)="deleteHandler(selectedUser.id)"
    >
    </button>
    <button
      type="button"
      pButton icon="pi pi-times"
      label="Cancelar"
      (click)="cancelHandler()"
    >
    </button>
  </p-footer>
</p-confirmDialog>

<p-toast position="top-center"></p-toast>


